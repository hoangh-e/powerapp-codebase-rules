# POWER APP CONTROL RULES - QUY T·∫ÆC CONTROLS

> **CRITICAL**: Quy t·∫Øc chi ti·∫øt v·ªÅ c√°c controls ƒë∆∞·ª£c ph√©p v√† c√°ch s·ª≠ d·ª•ng ch√∫ng trong Power App YAML.

---

## üìã M·ª§C L·ª§C
1. [Allowed Controls](#1-allowed-controls)
2. [Control Properties Restrictions](#2-control-properties-restrictions)
3. [Control Z-Index & Rendering Order](#3-control-z-index--rendering-order)
4. [Control Variants](#4-control-variants)

**UPDATED Control Property Rules:**
- [Control Properties Restrictions - Rule 10](#20-control-properties-restrictions---critical-rule-10)
- [Version Number Prohibition](#201-version-number-prohibition---all-controls)

**NEW DataTable Rules:**
- [DataTable vs Gallery Decision Rules](#18-datatable-vs-gallery-decision-rules)
- [DataTable Control Structure](#19-datatable-control-structure)
- [DataTableColumn Rules](#110-datatablecolumn-rules)
- [Critical DataTable Errors](#111-critical-datatable-errors)
- [DataTable Performance Guidelines](#112-datatable-performance-guidelines)
- [DataTable Decision Flowchart](#113-datatable-decision-flowchart)
- [DataTable Selection Handling](#114-datatable-selection-handling)

**NEW Control Property Rules:**
- [Classic/TextInput Focus Properties](#28-classictextinput-focus-properties)
- [Input & Dropdown Focus Properties](#29-input--dropdown-focus-properties---critical)
- [Collection vs Text Function Rules](#210-collection-vs-text-function-rules)
- [Table() Function Restrictions](#211-table-function-restrictions---critical)

---

## 1. ALLOWED CONTROLS

> **‚ö†Ô∏è CRITICAL FOCUS RULE**: T·∫§T C·∫¢ Input controls (bao g·ªìm c·∫£ `Classic/TextInput`) KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ `.Focus` ho·∫∑c `.Focused` properties. S·ª≠ d·ª•ng `FocusedBorderColor` v√† `FocusedBorderThickness` thay th·∫ø.

### 1.1 Input Controls
```yaml
# Text Input
Control: Classic/TextInput

# Buttons  
Control: Classic/Button

# Date Selection
Control: Classic/DatePicker

# Dropdowns
Control: Classic/DropDown
Control: Classic/ComboBox

# Selection Controls
Control: Classic/CheckBox
Control: Classic/Radio
Control: Classic/Toggle
Control: Classic/Slider
Control: Rating
Control: PenInput
```

### 1.2 Display Controls
```yaml
# Text Display
Control: Label

# Media Display
Control: Image
Control: HtmlViewer
Control: RichTextEditor
Control: PDFViewer

# Icons
Control: Classic/Icon
```

### 1.3 Layout Controls
```yaml
# Containers
Control: GroupContainer
Control: Rectangle

# Data Display
Control: Gallery
Control: Form
Control: FormViewer
Control: DataTable
```

### 1.4 Component Controls
```yaml
# Canvas Components
Control: CanvasComponent
ComponentName: ComponentName
```

### 1.5 Shape Controls
```yaml
Control: Circle
Control: Triangle
Control: Pentagon
Control: Octagon
Control: Star
Control: Arrow
Control: PartialCircle
```

### 1.6 Chart Controls

**CRITICAL**: `ColumnChart` control KH√îNG T·ªíN T·∫†I. S·ª≠ d·ª•ng `BarChart` thay th·∫ø.

#### 1.6.1 C√°c Chart Control ƒë∆∞·ª£c h·ªó tr·ª£
```yaml
# Bar/Column Charts
Control: BarChart          # D√πng cho column charts v√† bar charts

# Line Charts  
Control: LineChart

# Pie Charts
Control: PieChart

# Chart Legend
Control: Legend             # Hi·ªÉn th·ªã legend cho charts
```

#### 1.6.2 C·∫•u tr√∫c Chart Composite (B·∫ÆT BU·ªòC)
**MANDATORY**: Charts PH·∫¢I ƒë∆∞·ª£c t·ªï ch·ª©c trong composite structure v·ªõi Title, Chart, v√† Legend:

```yaml
# ‚úÖ ƒê√öNG - Composite Chart Structure
- Title1:
    Control: Label
    Group: CompositeColumnChart1    # Group name ƒë·ªÉ li√™n k·∫øt components
    Properties:
      Align: =Align.Center
      BorderColor: =RGBA(0, 0, 0, 1)
      Color: =RGBA(50, 49, 48, 1)
      Font: =Font.'Segoe UI'
      Height: =25
      Size: =14
      Text: ="Chart Title"
      Width: =400
      X: =40
      Y: =40

- ColumnChart1:
    Control: BarChart              # ‚ùó QUAN TR·ªåNG: D√πng BarChart, KH√îNG ph·∫£i ColumnChart
    Group: CompositeColumnChart1    # C√πng group name
    Properties:
      BorderColor: =RGBA(0, 0, 0, 0)
      BorderStyle: =BorderStyle.None
      BorderThickness: =2
      Color: =RGBA(50, 49, 48, 1)
      Font: =Font.'Segoe UI'
      ItemColorSet: =[RGBA(17, 141, 255, 1),RGBA(18,35,158, 1), RGBA(230,108,55,1), RGBA(107,0,123,1), RGBA(224,68,167,1), RGBA(116,78,194,1), RGBA(217,179,0,1), RGBA(214,69,80,1), RGBA(25, 114, 120, 1), RGBA(26, 171, 64, 1), RGBA(21, 198, 244, 1)]
      Items.Labels: =City            # Chart labels data
      Items.Series1: =Area           # Primary data series
      Items.Series2: =Density        # Additional series (optional)
      Items.Series3: =Population     # Additional series (optional)
      Size: =15
      X: =40
      Y: =70

- Legend1:
    Control: Legend
    Group: CompositeColumnChart1    # C√πng group name
    Properties:
      BorderColor: =RGBA(0, 0, 0, 0)
      BorderStyle: =BorderStyle.None
      Color: =RGBA(50, 49, 48, 1)
      Font: =Font.'Segoe UI'
      Height: =80
      ItemColorSet: =ColumnChart1.ItemColorSet  # Reference ƒë·∫øn chart colors
      Items: =ColumnChart1.SeriesLabels         # Reference ƒë·∫øn chart series
      Items.Value: =Value
      Width: =320
      X: =80
      Y: =480
```

#### 1.6.3 Chart Control Errors & Solutions
**COMMON ERROR**: `Unknown control type 'ColumnChart'`
```yaml
# ‚ùå SAI - Control kh√¥ng t·ªìn t·∫°i
Control: ColumnChart

# ‚úÖ ƒê√öNG - S·ª≠ d·ª•ng BarChart
Control: BarChart
```

#### 1.6.4 Chart Properties Requirements
**B·∫ÆT BU·ªòC** properties cho chart controls:
- `Items.Labels` - Data source cho chart labels
- `Items.Series1` - Primary data series (minimum requirement)
- `ItemColorSet` - Color palette cho chart
- `Group` - Group name ƒë·ªÉ li√™n k·∫øt v·ªõi Title v√† Legend

**T√ôY CH·ªåN** properties:
- `Items.Series2`, `Items.Series3`, etc. - Additional data series (ch·ªâ cho BarChart/LineChart)
- `BorderStyle`, `BorderColor`, `BorderThickness` - Chart border styling

#### 1.6.5 PieChart Composite Structure (B·∫ÆT BU·ªòC)
**MANDATORY**: PieChart c≈©ng PH·∫¢I ƒë∆∞·ª£c t·ªï ch·ª©c trong composite structure:

```yaml
# ‚úÖ ƒê√öNG - Composite PieChart Structure
- Title3:
    Control: Label
    Group: CompositePieChart1       # Group name ƒë·ªÉ li√™n k·∫øt components
    Properties:
      Align: =Align.Center
      BorderColor: =RGBA(0, 0, 0, 1)
      Color: =RGBA(50, 49, 48, 1)
      DisabledColor: =RGBA(161, 159, 157, 1)
      Font: =Font.'Segoe UI'
      Height: =25
      Size: =14
      Text: ="Chart Title"
      Width: =400
      X: =60
      Y: =60

- PieChart1:
    Control: PieChart               # PieChart control (kh√¥ng c√≥ version number)
    Group: CompositePieChart1       # C√πng group name
    Properties:
      BorderColor: =RGBA(0, 0, 0, 0)
      BorderStyle: =BorderStyle.None
      BorderThickness: =2
      Color: =RGBA(50, 49, 48, 1)
      DisabledBorderColor: =RGBA(0, 0, 0, 0)
      Font: =Font.'Segoe UI'
      HoverBorderColor: =RGBA(0, 0, 0, 0)
      ItemColorSet: =[RGBA(17, 141, 255, 1),RGBA(18,35,158, 1), RGBA(230,108,55,1), RGBA(107,0,123,1), RGBA(224,68,167,1), RGBA(116,78,194,1), RGBA(217,179,0,1), RGBA(214,69,80,1), RGBA(25, 114, 120, 1), RGBA(26, 171, 64, 1), RGBA(21, 198, 244, 1)]
      Items.Labels: =City           # Chart labels data
      Items.Series: =Area           # ‚ùó QUAN TR·ªåNG: PieChart ch·ªâ d√πng Items.Series (kh√¥ng c√≥ Series1, Series2)
      PressedBorderColor: =RGBA(0, 0, 0, 0)
      Size: =15
      X: =60
      Y: =90

- Legend3:
    Control: Legend
    Group: CompositePieChart1       # C√πng group name
    Properties:
      BorderColor: =RGBA(0, 0, 0, 0)
      BorderStyle: =BorderStyle.None
      BorderThickness: =2
      Color: =RGBA(50, 49, 48, 1)
      DisabledBorderColor: =RGBA(0, 0, 0, 0)
      DisabledColor: =RGBA(161, 159, 157, 1)
      DisabledFill: =RGBA(225, 223, 221, 1)
      Font: =Font.'Segoe UI'
      Height: =200
      HoverBorderColor: =RGBA(0, 0, 0, 0)
      ItemColorSet: =PieChart1.ItemColorSet    # Reference ƒë·∫øn pie chart colors
      Items: =PieChart1.SeriesLabels           # Reference ƒë·∫øn pie chart series
      Items.Value: =Value
      PressedBorderColor: =RGBA(0, 0, 0, 0)
      Size: =16
      Width: =400
      X: =60
      Y: =490
```

#### 1.6.6 Kh√°c bi·ªát gi·ªØa BarChart v√† PieChart Properties
**CRITICAL DIFFERENCES**:

**BarChart (Column Charts)**:
- S·ª≠ d·ª•ng `Items.Series1`, `Items.Series2`, etc. cho multiple data series
- H·ªó tr·ª£ multiple data series tr√™n c√πng m·ªôt chart

**PieChart**:
- Ch·ªâ s·ª≠ d·ª•ng `Items.Series` (singular) cho single data series  
- KH√îNG h·ªó tr·ª£ multiple series (Items.Series1, Items.Series2 s·∫Ω g√¢y l·ªói)

```yaml
# ‚úÖ ƒê√öNG - BarChart multiple series
Items.Series1: =Area
Items.Series2: =Population
Items.Series3: =Density

# ‚úÖ ƒê√öNG - PieChart single series
Items.Series: =Area

# ‚ùå SAI - PieChart v·ªõi multiple series
Items.Series1: =Area      # S·∫Ω g√¢y l·ªói
Items.Series2: =Population
```

### 1.7 Media & Data Controls
```yaml
# Media
Control: AddMedia
Control: Timer

# Data Import/Export
Control: Import
Control: Export
Control: ListBox
Control: PowerBI
```

### 1.8 DATATABLE VS GALLERY DECISION RULES

#### 1.8.1 KHI N√ÄO S·ª¨ D·ª§NG DATATABLE - B·∫ÆT BU·ªòC
**CRITICAL**: LU√îN LU√îN ∆∞u ti√™n s·ª≠ d·ª•ng DataTable thay v√¨ Gallery trong nh·ªØng tr∆∞·ªùng h·ª£p sau:

##### Database/SharePoint Data Lists
```yaml
# ‚úÖ ƒê√öNG - DataTable cho database data
Items: =User_1  # SharePoint table
Items: =Filter(NamecardRequest, Status = "Pending")
Items: =Department_1

# ‚ùå SAI - Gallery cho tabular database data  
# Gallery ch·ªâ d√πng cho custom layouts, kh√¥ng ph·∫£i tabular data
```

##### Forms c√≥ ch·ª©c nƒÉng Ch·ªânh s·ª≠a v√† T·∫°o m·ªõi - CRITICAL
**MANDATORY**: DataTable PH·∫¢I ƒë∆∞·ª£c s·ª≠ d·ª•ng khi screen c√≥ c√°c form/modal ƒë·ªÉ:
- **T·∫°o m·ªõi** record (Create/Add forms)
- **Ch·ªânh s·ª≠a** existing records (Edit/Update forms)
- **X√≥a** records v·ªõi confirmation
- **Qu·∫£n l√Ω** data v·ªõi CRUD operations

```yaml
# ‚úÖ ƒê√öNG - DataTable v·ªõi Edit/Create/Delete functionality
- UserManagementScreen v·ªõi:
  - DataTable hi·ªÉn th·ªã users
  - Add User form/modal
  - Edit User form/modal  
  - Delete confirmation modal

# ‚úÖ ƒê√öNG - DataTable v·ªõi CRUD operations
- NamecardRequestScreen v·ªõi:
  - DataTable hi·ªÉn th·ªã requests
  - Create Request form
  - Edit Request details
  - Approve/Reject actions

# ‚ùå SAI - Gallery cho data management screens
# Gallery kh√¥ng ph√π h·ª£p khi c·∫ßn edit/create/delete data
```

##### Tabular Data v·ªõi Multiple Columns
```yaml
# ‚úÖ ƒê√öNG - DataTable cho data c√≥ nhi·ªÅu columns c·∫ßn hi·ªÉn th·ªã
- Users: fullname, email, department, role, phone, actions
- Orders: orderID, customerName, orderDate, status, total, actions
- Products: name, category, price, quantity, supplier, actions

# ‚ùå SAI - Gallery cho structured tabular data v·ªõi action buttons
```

##### Data c·∫ßn Sorting/Filtering Built-in
```yaml
# ‚úÖ ƒê√öNG - DataTable c√≥ built-in sorting v√† selection
Control: DataTable
Properties:
  Items: =MyData
  # Built-in sorting by clicking column headers
  # Built-in row selection automatically handled
# User c√≥ th·ªÉ click column header ƒë·ªÉ sort v√† click row ƒë·ªÉ select

# ‚ùå SAI - Gallery c·∫ßn custom sorting/selection implementation
```

##### Management Screens Pattern - MANDATORY
**CRITICAL**: T·∫•t c·∫£ screens c√≥ pattern "Management" PH·∫¢I s·ª≠ d·ª•ng DataTable:

```yaml
# ‚úÖ ƒê√öNG - Management screens v·ªõi DataTable
- UserManagementScreen    # Qu·∫£n l√Ω ng∆∞·ªùi d√πng
- RequestManagementScreen # Qu·∫£n l√Ω y√™u c·∫ßu  
- OrderManagementScreen   # Qu·∫£n l√Ω ƒë∆°n h√†ng
- ProductManagementScreen # Qu·∫£n l√Ω s·∫£n ph·∫©m

# Pattern: DataTable + Add/Edit/Delete forms + Search/Filter
```

#### 1.8.2 KHI N√ÄO S·ª¨ D·ª§NG GALLERY
**CH·ªà** s·ª≠ d·ª•ng Gallery trong nh·ªØng tr∆∞·ªùng h·ª£p n√†y:

##### Custom Visual Layouts
```yaml
# ‚úÖ ƒê√öNG - Gallery cho custom card layouts
- Image thumbnails v·ªõi text
- Dashboard cards v·ªõi icons v√† metrics
- Chat message bubbles
- Product cards v·ªõi images
```

##### Non-Tabular Data Presentation
```yaml
# ‚úÖ ƒê√öNG - Gallery cho non-structured presentation
- Photo galleries
- News article cards  
- Social media posts
- Dashboard widgets
```

### 1.9 DATATABLE CONTROL STRUCTURE

#### 1.9.1 Basic DataTable Structure - B·∫ÆT BU·ªòC
```yaml
# ‚úÖ ƒê√öNG - DataTable structure (NO version numbers, NO OnSelect)
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      # DataTable automatically handles selection - no OnSelect property
    Children:
      - Column1:
          Control: DataTableColumn
          Variant: Textual
          Properties:
            FieldDisplayName: ="Display Name"
            FieldName: ="LogicalName"
            Order: =1
            Text: =ThisItem.LogicalName

# ‚ùå SAI - Version numbers v√† OnSelect KH√îNG ƒë∆∞·ª£c ph√©p
- MyDataTable:
    Control: DataTable@1.0.3  # PA2108 Error - No version numbers
    Properties:
      OnSelect: =Set(varSelected, Self.Selected)  # PA2108 Error - Not supported
```

#### 1.9.2 DataTable v·ªõi SharePoint Data
```yaml
# ‚úÖ ƒê√öNG - DataTable cho SharePoint tables (NO OnSelect property)
- UsersTable:
    Control: DataTable
    Properties:
      Items: =User_1  # SharePoint table reference
      # Selection automatically handled by DataTable control
    Children:
      - FullName.Column:
          Control: DataTableColumn
          Variant: Textual
          Properties:
            FieldDisplayName: ="H·ªç v√† t√™n"
            FieldName: ="fullname"
            Order: =1
            Text: =ThisItem.fullname
      - Email.Column:
          Control: DataTableColumn
          Variant: Textual
          Properties:
            FieldDisplayName: ="Email"
            FieldName: ="email"
            Order: =2
            Text: =ThisItem.email
```

### 1.10 DATATABLECOLUMN RULES

#### 1.10.1 Required DataTableColumn Properties
**B·∫ÆT BU·ªòC**: M·ªçi DataTableColumn PH·∫¢I c√≥ nh·ªØng properties n√†y:

```yaml
Properties:
  FieldDisplayName: ="User Friendly Name"  # T√™n hi·ªÉn th·ªã cho user
  FieldName: ="logical_name"               # T√™n field trong data source
  Order: =1                                # Th·ª© t·ª± column (b·∫Øt ƒë·∫ßu t·ª´ 1)
  Text: =ThisItem.field_name               # Gi√° tr·ªã hi·ªÉn th·ªã
```

#### 1.10.2 DataTableColumn Variants - SUPPORTED ONLY
**CH·ªà** s·ª≠ d·ª•ng nh·ªØng variants n√†y (PA2109 Error n·∫øu s·ª≠ d·ª•ng variants kh√°c):

```yaml
# Text data - SUPPORTED
Variant: Textual

# Number data - SUPPORTED
Variant: Number  

# Date/Time data - SUPPORTED
Variant: DateTime

# Boolean data - SUPPORTED
Variant: Boolean

# ‚ùå KH√îNG H·ªñ TR·ª¢ - Custom variant causes PA2109 Error
# Variant: Custom  # ERROR - Not supported
```

#### 1.10.3 DataTableColumn Width Management
```yaml
# ‚úÖ ƒê√öNG - Specify column widths
Properties:
  Width: =200      # Fixed width
  Width: =Parent.Width * 0.25  # Relative width

# ‚úÖ ƒê√öNG - Let DataTable auto-size
# Kh√¥ng specify Width property cho auto-sizing
```

### 1.11 CRITICAL DATATABLE ERRORS

#### 1.11.1 Version Number Prohibition - PA2108/PA2109 Prevention (Rule 10)
**NEVER** include version numbers trong ANY control declarations:

```yaml
# ‚ùå FORBIDDEN - Causes PA2108 errors
Control: DataTable@1.0.3
Control: DataTableColumn@1.0.1  
Control: GroupContainer@1.3.0
Control: Classic/Button@2.2.0

# ‚úÖ REQUIRED - No version numbers
Control: DataTable
Control: DataTableColumn
Control: GroupContainer  
Control: Classic/Button
```

**CRITICAL**: This applies to ALL controls, not just DataTable. Version numbers cause parsing errors and are never supported trong Power Apps YAML format.

#### 1.11.2 Missing Required Properties
```yaml
# ‚ùå SAI - Missing required properties
- MyColumn:
    Control: DataTableColumn
    Properties:
      Text: =ThisItem.Name  # Missing FieldName, FieldDisplayName, Order

# ‚úÖ ƒê√öNG - All required properties
- MyColumn:
    Control: DataTableColumn
    Variant: Textual
    Properties:
      FieldDisplayName: ="Name"
      FieldName: ="Name"  
      Order: =1
      Text: =ThisItem.Name
```

#### 1.11.3 DataTable Screen Children Only - CRITICAL RULE
**CRITICAL**: DataTable controls MUST be direct Children of Screens ONLY. Never nest DataTable inside GroupContainer or other containers.

```yaml
# ‚úÖ ƒê√öNG - DataTable as direct Screen child
Screens:
  MyScreen:
    Children:
      - MyDataTable:
          Control: DataTable
          Properties:
            X: =Parent.Width * 0.03
            Y: =Parent.Height * 0.3  
            Items: =MyDataSource

# ‚ùå SAI - DataTable nested in containers
Screens:
  MyScreen:
    Children:
      - Container:
          Control: GroupContainer
          Children:
            - MyDataTable:  # ERROR - Cannot nest DataTable
                Control: DataTable
```

#### 1.11.4 DataTable Event Properties - CRITICAL ERROR
**CRITICAL**: DataTable control does NOT support OnSelect OR OnSelectionChange properties (PA2108 error).

```yaml
# ‚ùå SAI - DataTable kh√¥ng h·ªó tr·ª£ OnSelect
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      OnSelect: |
        =Set(varSelectedItem, Self.Selected)  # PA2108 Error

# ‚ùå SAI - DataTable kh√¥ng h·ªó tr·ª£ OnSelectionChange  
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      OnSelectionChange: |
        =Set(varSelectedItem, Self.Selected)  # PA2108 Error

# ‚úÖ ƒê√öNG - DataTable ch·ªâ c√≥ Items property, selection via overlay handler
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      # Access selection via Self.Selected trong separate overlay handler
```

#### 1.11.5 DataTableColumn Custom Variant - PA2109 ERROR
**CRITICAL**: DataTableColumn does NOT support 'Custom' variant. Use only supported variants.

```yaml
# ‚ùå SAI - Custom variant kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£
- ActionColumn:
    Control: DataTableColumn
    Variant: Custom  # PA2109 Error
    Properties:
      FieldDisplayName: ="Actions"

# ‚úÖ ƒê√öNG - Ch·ªâ s·ª≠ d·ª•ng supported variants
- ActionColumn:
    Control: DataTableColumn
    Variant: Textual  # Supported variant
    Properties:
      FieldDisplayName: ="Actions"
      FieldName: ="Actions"
      Order: =5
      Text: ="Edit | Delete"
```

#### 1.11.6 DataTableColumn Reference Rules - CRITICAL
**CRITICAL**: In DataTableColumn context, use proper data references.

```yaml
# ‚ùå SAI - Sai reference context
- NameColumn:
    Control: DataTableColumn
    Properties:
      OnSelect: |
        =Set(varSelectedItem, ThisItem)  # ERROR - ThisItem not available in column

# ‚úÖ ƒê√öNG - DataTableColumn ch·ªâ hi·ªÉn th·ªã data, kh√¥ng handle events
- NameColumn:
    Control: DataTableColumn
    Variant: Textual
    Properties:
      FieldDisplayName: ="Full Name"
      FieldName: ="fullname"
      Order: =1
      Text: =ThisItem.fullname  # Correct for display
```

#### 1.11.7 DataTable OnSelectionChange Error - PA2108 CRITICAL FIX
**CRITICAL**: PA2108 Error "Unknown property 'OnSelectionChange' for control type 'DataTable'" - DataTable does NOT support this property.

```yaml
# ‚ùå SAI - OnSelectionChange causes PA2108 error
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      OnSelectionChange: |  # PA2108 ERROR - Property not supported
        =Set(varSelectedItem, Self.Selected)

# ‚úÖ ƒê√öNG - Use overlay handler for selection detection
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      # Only Items property supported for DataTable

# Separate overlay for selection handling
- DataTable.SelectionOverlay:
    Control: Rectangle
    Properties:
      Fill: =RGBA(0, 0, 0, 0)  # Invisible
      Height: =MyDataTable.Height
      Width: =MyDataTable.Width  
      X: =MyDataTable.X
      Y: =MyDataTable.Y
      OnSelect: |
        =If(Not(IsBlank(MyDataTable.Selected)),
          Set(varSelectedItem, MyDataTable.Selected);
          # Additional selection logic here
        )
```

**SOLUTION PATTERN**: Always use separate Rectangle overlay positioned over DataTable for selection event handling.

### 1.12 DATATABLE PERFORMANCE GUIDELINES

#### 1.12.1 Filter at Data Source Level
```yaml
# ‚úÖ ƒê√öNG - Filter tr∆∞·ªõc khi pass v√†o DataTable
Items: |
  =Filter(Users, 
    And(
      Status = "Active",
      Department = varSelectedDepartment
    )
  )

# ‚ùå SAI - Load all data then rely on DataTable filtering
Items: =Users  # Load everything
```

#### 1.12.2 Use Proper Column Data Types
```yaml
# ‚úÖ ƒê√öNG - S·ª≠ d·ª•ng proper variants
- DateColumn:
    Variant: DateTime
    Properties:
      Text: =Text(ThisItem.CreatedDate, DateTimeFormat.ShortDate)

- NumberColumn:
    Variant: Number  
    Properties:
      Text: =Text(ThisItem.Amount, "$#,##0.00")

# ‚ùå SAI - All columns as Textual
- DateColumn:
    Variant: Textual  # SAI - should be DateTime
```

#### 1.12.3 DataTable vs Gallery Performance
**DataTable WINS khi:**
- Tabular data v·ªõi > 100 rows
- Multiple sortable columns
- Need built-in selection
- Professional table appearance

**Gallery WINS khi:**
- Custom visual layouts
- Rich media content (images, videos)
- Card-based presentation
- < 50 items v·ªõi complex layouts

### 1.13 DATATABLE DECISION FLOWCHART

```
C√≥ ph·∫£i screen Management (CRUD operations)?
‚îú‚îÄ‚îÄ YES ‚Üí ALWAYS use DataTable ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ Create/Add forms ‚Üí DataTable required
‚îÇ   ‚îú‚îÄ‚îÄ Edit/Update forms ‚Üí DataTable required  
‚îÇ   ‚îî‚îÄ‚îÄ Delete operations ‚Üí DataTable required
‚îî‚îÄ‚îÄ NO ‚Üí Is it database/SharePoint data?
    ‚îú‚îÄ‚îÄ YES ‚Üí Is it tabular (rows/columns)?
    ‚îÇ   ‚îú‚îÄ‚îÄ YES ‚Üí Use DataTable ‚úÖ
    ‚îÇ   ‚îî‚îÄ‚îÄ NO ‚Üí Consider Gallery
    ‚îî‚îÄ‚îÄ NO ‚Üí Is it custom visual layout?
        ‚îú‚îÄ‚îÄ YES ‚Üí Use Gallery ‚úÖ
        ‚îî‚îÄ‚îÄ NO ‚Üí Use DataTable for structured data
```

### 1.14 DATATABLE SELECTION HANDLING - CRITICAL

#### 1.14.1 DataTable Selection Handling - CRITICAL ERROR FIXED
**CRITICAL**: DataTable does NOT support OnSelectionChange property (PA2108 error). Use separate overlay handler for selection detection.

```yaml
# ‚ùå SAI - DataTable kh√¥ng h·ªó tr·ª£ OnSelectionChange property
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      OnSelectionChange: |
        =Set(varSelectedItem, Self.Selected)  # PA2108 Error - Property not supported

# ‚úÖ ƒê√öNG - DataTable without OnSelectionChange, use overlay for selection
- MyDataTable:
    Control: DataTable
    Properties:
      Items: =MyDataSource
      # DataTable selection accessed via Self.Selected in overlay handler

# ‚úÖ ƒê√öNG - Separate overlay handler for selection detection
- DataTable.Selection.Handler:
    Control: Rectangle
    Properties:
      Fill: =RGBA(0, 0, 0, 0)  # Invisible overlay
      Height: =MyDataTable.Height
      Width: =MyDataTable.Width
      X: =MyDataTable.X
      Y: =MyDataTable.Y
      OnSelect: |
        =If(Not(IsBlank(MyDataTable.Selected)),
          Set(varSelectedItem, MyDataTable.Selected);
          Set(varShowContextMenu, true)
        )
```

#### 1.14.2 DataTable Context Menu Pattern - CORRECTED
**CRITICAL**: Context menus require separate overlay handler since DataTable does NOT support OnSelectionChange.

```yaml
# ‚úÖ ƒê√öNG - DataTable with proper context menu support
- Users.DataTable:
    Control: DataTable
    Properties:
      Items: =FilteredUsers
      # NO OnSelectionChange property - not supported
    Children:
      # DataTable columns here...

# ‚úÖ ƒê√öNG - Separate overlay handler for context menu
- DataTable.Context.Handler:
    Control: Rectangle
    Properties:
      Fill: =RGBA(0, 0, 0, 0)  # Invisible overlay
      Height: ='Users.DataTable'.Height
      Width: ='Users.DataTable'.Width
      X: ='Users.DataTable'.X
      Y: ='Users.DataTable'.Y
      OnSelect: |
        =If(Not(IsBlank('Users.DataTable'.Selected)),
          Set(varSelectedUser, 'Users.DataTable'.Selected);
          Set(varContextMenuX, Min(App.ActiveScreen.Width - 150, App.MouseX));
          Set(varContextMenuY, Min(App.ActiveScreen.Height - 120, App.MouseY));
          Set(varShowContextMenu, true)
        )

# ‚ùå SAI - DataTable with OnSelectionChange causes PA2108 error
- Users.DataTable:
    Control: DataTable
    Properties:
      OnSelectionChange: =Set(varSelected, Self.Selected)  # ERROR - Not supported
```

#### 1.14.3 Context Menu Z-Index Rules
**CRITICAL**: Context menus MUST be positioned last trong Children array ƒë·ªÉ ensure highest z-index.

```yaml
# ‚úÖ ƒê√öNG - Context menu positioning trong Children array
Children:
  # 1. Background elements first
  - Background:
      Control: Rectangle
  
  # 2. Data display elements
  - Users.DataTable:
      Control: DataTable
      
  # 3. Interactive overlays
  - DataTable.Overlay.Handler:
      Control: Rectangle
      
  # 4. Context menus LAST (highest z-index)
  - User.Context.Menu:
      Control: GroupContainer
      Properties:
        Visible: =varShowContextMenu

# ‚ùå SAI - Context menu positioned early trong Children array
Children:
  - User.Context.Menu:  # ERROR - S·∫Ω b·ªã other elements cover
      Control: GroupContainer
  - Users.DataTable:
      Control: DataTable
```

#### 1.13.1 DataTable Decision Matrix

| Screen Type | Has CRUD Forms | Data Source | Layout | Recommendation |
|-------------|----------------|-------------|---------|----------------|
| **UserManagement** | ‚úÖ Create/Edit/Delete | SharePoint | Tabular | **DataTable** ‚úÖ |
| **RequestManagement** | ‚úÖ Create/Edit/Approve | SharePoint | Tabular | **DataTable** ‚úÖ |
| **OrderManagement** | ‚úÖ Create/Edit/Delete | Database | Tabular | **DataTable** ‚úÖ |
| **Dashboard Stats** | ‚ùå View only | API | Cards | **Gallery** ‚úÖ |
| **Photo Gallery** | ‚ùå View only | Files | Grid | **Gallery** ‚úÖ |
| **News Feed** | ‚ùå View only | API | Cards | **Gallery** ‚úÖ |
| **Reports List** | ‚úÖ Create/Edit | SharePoint | Tabular | **DataTable** ‚úÖ |

#### 1.13.2 CRUD Pattern Recognition
**IDENTIFY** these patterns requiring DataTable:

```yaml
# PATTERN 1: Management Screen v·ªõi Add/Edit/Delete
Screen c√≥:
- Add/Create button
- Edit action trong rows  
- Delete confirmation
- Search/filter functionality
‚Üí USE DataTable

# PATTERN 2: Admin/Configuration Screen  
Screen c√≥:
- Settings management
- User role management  
- System configuration
‚Üí USE DataTable

# PATTERN 3: Workflow Management
Screen c√≥:
- Approval workflows
- Status updates
- Bulk operations
‚Üí USE DataTable
```

---

## 2. CONTROL PROPERTIES RESTRICTIONS

### 2.0 Control Properties Restrictions - CRITICAL (Rule 10)
**MANDATORY**: Follow these universal control restrictions ƒë·ªÉ prevent PA2108/PA2109 errors:

#### 2.0.1 Version Number Prohibition - ALL CONTROLS
**NEVER** include version numbers trong ANY control declarations:

```yaml
# ‚ùå FORBIDDEN - Causes PA2108/PA2109 errors
Control: DataTable@1.0.3        # Error: PA2108
Control: DataTableColumn@1.0.1   # Error: PA2109  
Control: GroupContainer@1.3.0    # Error: PA2108
Control: Classic/Button@2.2.0    # Error: PA2108
Control: Classic/TextInput@1.5.1 # Error: PA2108
Control: Rectangle@2.1.0         # Error: PA2108

# ‚úÖ REQUIRED - Clean control names only
Control: DataTable
Control: DataTableColumn
Control: GroupContainer  
Control: Classic/Button
Control: Classic/TextInput
Control: Rectangle
```

#### 2.0.2 Universal Property Restrictions
**NEVER** use these properties on ANY control unless explicitly documented:

```yaml
# ‚ùå FORBIDDEN - Universal restrictions
Columns: =3          # Not supported on Form/FormViewer controls
Version: ="1.0"      # Never specify version properties
@version: ="1.0.3"   # Never use @ syntax with controls
Variant: ="Custom"   # Custom variants not supported (PA2109)
```

### 2.1 Rectangle Control - C·∫§M S·ª¨ D·ª§NG
**Rectangle Control** - KH√îNG BAO GI·ªú s·ª≠ d·ª•ng nh·ªØng properties n√†y:
- `RadiusBottomLeft` - Kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£
- `RadiusBottomRight` - Kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£  
- `RadiusTopLeft` - Kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£
- `RadiusTopRight` - Kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£
- `Variant` - Rectangle KH√îNG h·ªó tr·ª£ Variant property
- `DropShadow` - Rectangle KH√îNG h·ªó tr·ª£ DropShadow property
- `BorderRadius` - Rectangle KH√îNG h·ªó tr·ª£ BorderRadius property

```yaml
# ‚ùå SAI - Rectangle v·ªõi properties kh√¥ng h·ªó tr·ª£
- 'MyRectangle':
    Control: Rectangle
    Properties:
      RadiusTopLeft: =8        # PA2108 Error
      Variant: ManualLayout    # PA2108 Error
      DropShadow: =DropShadow.Light  # PA2108 Error

# ‚úÖ ƒê√öNG - Rectangle v·ªõi properties h·ªó tr·ª£
- 'MyRectangle':
    Control: Rectangle
    Properties:
      Fill: =RGBA(255, 255, 255, 1)
      BorderColor: =RGBA(230, 230, 230, 1)
      BorderThickness: =2
```

### 2.2 Classic/Button Control - C·∫§M S·ª¨ D·ª§NG
**Classic/Button Control** - KH√îNG BAO GI·ªú s·ª≠ d·ª•ng nh·ªØng properties n√†y:
- `BorderRadius` - Kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£ cho Classic/Button
- `Disabled` - S·ª≠ d·ª•ng `DisplayMode` thay th·∫ø
- `Align` - Kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£ cho buttons
- `Children` - Classic/Button kh√¥ng h·ªó tr·ª£ Children property 

```yaml
# ‚ùå SAI - Classic/Button v·ªõi properties kh√¥ng h·ªó tr·ª£
- 'MyButton':
    Control: Classic/Button
    Properties:
      BorderRadius: =8           # PA2108 Error
      Disabled: =true            # PA2108 Error
      Align: =Align.Center       # PA2108 Error

# ‚úÖ ƒê√öNG - Classic/Button v·ªõi properties h·ªó tr·ª£
- 'MyButton':
    Control: Classic/Button
    Properties:
      DisplayMode: =If(varIsDisabled, DisplayMode.Disabled, DisplayMode.Edit)
      Fill: =RGBA(0, 120, 212, 1)
      Color: =RGBA(255, 255, 255, 1)
```

### 2.3 Classic/TextInput Control - QUY T·∫ÆC ƒê√öNG
**Classic/TextInput Control** - S·ª≠ d·ª•ng properties ƒê√öNG:

```yaml
# ‚úÖ ƒê√öNG - Classic/TextInput properties
- 'MyTextInput':
    Control: Classic/TextInput
    Properties:
      Default: ="Default value"        # S·ª≠ d·ª•ng Default (KH√îNG ph·∫£i Text)
      HintText: ="Enter text here"     # S·ª≠ d·ª•ng HintText (KH√îNG ph·∫£i Placeholder)
      Mode: =TextMode.Password         # S·ª≠ d·ª•ng Mode (KH√îNG ph·∫£i TextMode)

# ‚ùå SAI - Classic/TextInput v·ªõi properties sai
- 'MyTextInput':
    Control: Classic/TextInput
    Properties:
      Text: ="Default value"          # PA2108 Error - s·ª≠ d·ª•ng Default
      Placeholder: ="Enter text"      # PA2108 Error - s·ª≠ d·ª•ng HintText
      TextMode: =TextMode.Password    # PA2108 Error - s·ª≠ d·ª•ng Mode
```

### 2.4 GroupContainer Control - C·∫§M S·ª¨ D·ª§NG
**GroupContainer Control** - KH√îNG BAO GI·ªú s·ª≠ d·ª•ng nh·ªØng properties n√†y:
- `OnSelect` - GroupContainer kh√¥ng h·ªó tr·ª£ event properties
- `OnClick` - GroupContainer kh√¥ng h·ªó tr·ª£ event properties
- `BorderRadius` - GroupContainer kh√¥ng h·ªó tr·ª£ BorderRadius
- `HoverFill` - GroupContainer kh√¥ng h·ªó tr·ª£ hover states
- `HoverColor` - GroupContainer kh√¥ng h·ªó tr·ª£ hover states
- `HoverBorderColor` - GroupContainer kh√¥ng h·ªó tr·ª£ hover states
- `PressedFill` - GroupContainer kh√¥ng h·ªó tr·ª£ pressed states
- `PressedColor` - GroupContainer kh√¥ng h·ªó tr·ª£ pressed states
- `PressedBorderColor` - GroupContainer kh√¥ng h·ªó tr·ª£ pressed states

```yaml
# ‚ùå SAI - GroupContainer v·ªõi event properties
- 'MyContainer':
    Control: GroupContainer
    Properties:
      OnSelect: =Navigate(NextScreen)  # PA2108 Error
      BorderRadius: =8                 # PA2108 Error

# ‚úÖ ƒê√öNG - S·ª≠ d·ª•ng Rectangle cho interactive containers
- 'MyContainer':
    Control: Rectangle
    Properties:
      OnSelect: =Navigate(NextScreen)  # Rectangle h·ªó tr·ª£ events
      Fill: =RGBA(255, 255, 255, 1)
```

### 2.5 Gallery Control - VARIANT RESTRICTIONS
**Gallery Control** - Restrictions theo Variant:

```yaml
# ‚ùå SAI - VariableHeight kh√¥ng h·ªó tr·ª£ WrapCount
- 'MyGallery':
    Control: Gallery
    Variant: VariableHeight
    Properties:
      WrapCount: =7  # PA2108 Error cho VariableHeight

# ‚úÖ ƒê√öNG - WrapCount ch·ªâ cho Horizontal/Vertical variants
- 'MyGallery':
    Control: Gallery
    Variant: Horizontal
    Properties:
      WrapCount: =7  # H·ªó tr·ª£ cho Horizontal/Vertical variants
      TemplateSize: =Self.Height / 5  # B·∫Øt bu·ªôc cho t·∫•t c·∫£ Gallery variants
```

### 2.6 DataTable Control - RULES
**DataTable Control** - Quy t·∫Øc s·ª≠ d·ª•ng:
- **ALWAYS** use as direct Screen children only
- **NEVER** nest inside GroupContainer or other containers
- **REQUIRED** properties: Items (only)
- **FORBIDDEN** properties: OnSelect, OnSelectionChange (causes PA2108 error)
- **VERSION NUMBERS**: Never use @1.0.3 syntax
- **CHILDREN**: Must contain DataTableColumn controls only
- **SELECTION HANDLING**: Use separate overlay Rectangle with OnSelect to detect DataTable.Selected

### 2.7 DataTableColumn Control - RULES  
**DataTableColumn Control** - Properties B·∫ÆT BU·ªòC:
- `FieldDisplayName` - ALWAYS required for user display
- `FieldName` - ALWAYS required for data binding
- `Order` - ALWAYS required for column sequence
- `Text` - ALWAYS required for content display
- `Variant` - ALWAYS specify (Textual, Number, DateTime, Boolean ONLY)

**DataTableColumn Control** - FORBIDDEN Properties:
- `Variant: Custom` - Causes PA2109 error, NOT supported
- `OnSelect` - DataTableColumn kh√¥ng h·ªó tr·ª£ event properties

**DataTableColumn Control** - Reference Rules:
- **USE**: `ThisItem.fieldname` for data display only
- **NEVER USE**: Event properties trong DataTableColumn
- **CONTEXT**: DataTableColumn ch·ªâ ƒë·ªÉ hi·ªÉn th·ªã data, kh√¥ng handle events

### 2.8 Classic/TextInput Focus Properties - CRITICAL
**Classic/TextInput Control** - Focus Property Rules:

```yaml
# ‚ùå SAI - Classic/TextInput KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus
- MyTextInput:
    Control: Classic/TextInput
    Properties:
      BorderColor: =If(Self.Focus, Colors.Primary, Colors.Border)  # PA2108 Error
      Fill: =If(Self.Focus, Colors.LightBlue, Colors.White)        # PA2108 Error

# ‚ùå SAI - Classic/TextInput KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focused
- MyTextInput:
    Control: Classic/TextInput
    Properties:
      BorderColor: =If(Self.Focused, Colors.Primary, Colors.Border)  # PA2108 Error

# ‚úÖ ƒê√öNG - S·ª≠ d·ª•ng FocusedBorderColor thay th·∫ø
- MyTextInput:
    Control: Classic/TextInput
    Properties:
      FocusedBorderColor: =Colors.Primary
      FocusedBorderThickness: =2
      BorderColor: =Colors.Border

# NOTE: Classic/TextInput KH√îNG h·ªó tr·ª£ .Focus v√† KH√îNG h·ªó tr·ª£ .Focused
```

**Classic/TextInput Control** - Validation Patterns:
```yaml
# ‚úÖ ƒê√öNG - Real-time validation KH√îNG s·ª≠ d·ª•ng Focus state
BorderColor: =If(IsBlank(Self.Text), Colors.Border, 
    If(IsMatch(Self.Text, Email), Colors.Success, Colors.Error)
  )

# Visual validation KH√îNG s·ª≠ d·ª•ng Focus detection
ValidationIcon.Visible: =Not(IsBlank(Self.Text))
ValidationIcon.Color: =If(IsBlank(Self.Text), Colors.Error, Colors.Success)
```

### 2.9 Input & Dropdown Focus Properties - CRITICAL
**Input v√† Dropdown Controls** - Focus Property Restrictions:

**CRITICAL**: T·∫§T C·∫¢ Input controls (bao g·ªìm c·∫£ "input" n√≥i chung v√† Classic/TextInput) KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused properties.

```yaml
# ‚ùå SAI - T·∫§T C·∫¢ Input controls (bao g·ªìm Classic/TextInput) KH√îNG c√≥ focus/focused properties
- MyTextInput:
    Control: Classic/TextInput
    Properties:
      BorderColor: =If(Self.Focus, Colors.Primary, Colors.Border)    # PA2108 Error
      Fill: =If(Self.Focused, Colors.LightBlue, Colors.White)        # PA2108 Error

- MyDropDown:
    Control: Classic/DropDown
    Properties:
      BorderColor: =If(Self.Focus, Colors.Primary, Colors.Border)    # PA2108 Error
      Fill: =If(Self.Focused, Colors.LightBlue, Colors.White)        # PA2108 Error

- MyComboBox:
    Control: Classic/ComboBox  
    Properties:
      BorderColor: =If(Self.Focus, Colors.Primary, Colors.Border)    # PA2108 Error

- MyDatePicker:
    Control: Classic/DatePicker
    Properties:
      Fill: =If(Self.Focused, Colors.LightBlue, Colors.White)        # PA2108 Error

# ‚úÖ ƒê√öNG - S·ª≠ d·ª•ng OnSelect ƒë·ªÉ theo d√µi v√† FocusedBorderColor/FocusedBorderThickness cho focus styling
- MyTextInput:
    Control: Classic/TextInput
    Properties:
      FocusedBorderColor: =Colors.Primary
      FocusedBorderThickness: =2
      BorderColor: =Colors.Border
      Fill: =Colors.White
    OnChange: |
      =Set(varTextInputChanged, true)

- MyDropDown:
    Control: Classic/DropDown
    Properties:
      FocusedBorderColor: =Colors.Primary
      FocusedBorderThickness: =2
      BorderColor: =Colors.Border
      Fill: =Colors.White
    OnSelect: |
      =Set(varDropdownSelected, true)
    
# ‚úÖ ƒê√öNG - S·ª≠ d·ª•ng FocusedBorderColor thay v√¨ .Focus property
- MyComboBox:
    Control: Classic/ComboBox
    Properties:
      FocusedBorderColor: =Colors.Primary
      FocusedBorderThickness: =2
      HoverFill: =Colors.LightBlue
      PressedFill: =Colors.Primary
      BorderColor: =Colors.Border
    OnSelect: |
      =Set(varComboBoxSelected, true)

# ‚úÖ ƒê√öNG - DatePicker v·ªõi focus styling
- MyDatePicker:
    Control: Classic/DatePicker
    Properties:
      FocusedBorderColor: =Colors.Primary
      FocusedBorderThickness: =2
      BorderColor: =Colors.Border
    OnSelect: |
      =Set(varDateSelected, true)

# NOTE: T·∫§T C·∫¢ input controls (bao g·ªìm Classic/TextInput v√† "input" n√≥i chung) KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
# THAY TH·∫æ: S·ª≠ d·ª•ng FocusedBorderColor + FocusedBorderThickness cho focus styling v√† OnSelect cho tracking
```

**Input Controls KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ Focus/Focused Properties:**
- `Classic/TextInput` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `Classic/DropDown` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `Classic/ComboBox` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused  
- `Classic/DatePicker` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `Classic/CheckBox` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `Classic/Radio` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `Classic/Toggle` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `Classic/Slider` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `Rating` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- `PenInput` - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused
- **T·∫•t c·∫£ "input" controls kh√°c** - KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ .Focus ho·∫∑c .Focused

**KH√îNG C√ì EXCEPTION:** T·∫§T C·∫¢ Input controls bao g·ªìm `Classic/TextInput` ƒë·ªÅu KH√îNG ƒë∆∞·ª£c h·ªó tr·ª£ `.Focus` v√† `.Focused`.

**RECOMMENDED APPROACH cho Input/Dropdown Focus:**
- **Border Styling**: S·ª≠ d·ª•ng `FocusedBorderColor` v√† `FocusedBorderThickness` properties
- **Tracking**: S·ª≠ d·ª•ng `OnSelect` event ƒë·ªÉ set variables cho state management
- **Alternative**: `HoverFill`, `PressedFill` cho visual feedback

### 2.10 Collection vs Text Function Rules - CRITICAL
**Collection Functions** - Proper Usage:

```yaml
# ‚úÖ ƒê√öNG - Concat() cho collections/tables
Items: |
  =Concat(
    Table({Name: "T·∫•t c·∫£"}),
    AddColumns(Department_1, "Name", name)
  )

# ‚úÖ ƒê√öNG - Concatenate() cho text strings  
Text: =Concatenate("Hello ", userName, "!")

# ‚ùå SAI - Concatenate() cho tables causes error
Items: |
  =Concatenate(
    Table({Name: "T·∫•t c·∫£"}),
    Department_1  # Invalid argument type error
  )

# ‚ùå SAI - Concat() cho text strings kh√¥ng optimal
Text: =Concat(Table({Value: "Hello"}), Table({Value: userName}))
```

**Function Selection Rules**:
- **Concatenate()** = Text function ONLY
- **Concat()** = Collection/Table function ONLY  
- **& operator** = Text concatenation alternative
- **Union()** = Table combination alternative

### 2.11 Table() Function Restrictions - CRITICAL
**ALWAYS AVOID Table()** - Use Collection Management Functions Instead:

```yaml
# ‚ùå SAI - Table() function t·∫°o temporary data, kh√¥ng efficient
OnSelect: |
  =Set(varOptions, Table(
    {ID: 1, Name: "Option 1"},
    {ID: 2, Name: "Option 2"},
    {ID: 3, Name: "Option 3"}
  ))

# ‚úÖ ƒê√öNG - ClearCollect() cho collection initialization
OnSelect: |
  =ClearCollect(colOptions,
    {ID: 1, Name: "Option 1"},
    {ID: 2, Name: "Option 2"},
    {ID: 3, Name: "Option 3"}
  )

# ‚ùå SAI - Table() trong Items property
Items: =Table(
  {Value: "All Departments"},
  {Value: "IT"},
  {Value: "HR"}
)

# ‚úÖ ƒê√öNG - S·ª≠ d·ª•ng pre-populated collection
Items: =colDepartmentOptions  # Populated via ClearCollect trong OnStart
```

**Collection Management Priorities**:
1. **ClearCollect()** - Replace entire collection (preferred for initialization)
2. **Collect()** - Add records to existing collection
3. **Remove()/RemoveIf()** - Remove specific records
4. **Update()/UpdateIf()** - Modify existing records
5. **AVOID Table()** - Only use when absolutely necessary for single-use scenarios

**Performance Benefits c·ªßa Collection Functions**:
```yaml
# ‚úÖ ƒê√öNG - Collections maintain state v√† performance
OnStart: |
  =Concurrent(
    ClearCollect(colDepartments, Department_1),
    ClearCollect(colUsers, User_1),
    ClearCollect(colStatuses, 
      {ID: 1, Name: "Active", Color: "Green"},
      {ID: 2, Name: "Inactive", Color: "Red"},
      {ID: 3, Name: "Pending", Color: "Orange"}
    )
  )

# Items references cached collections
MyDropdown.Items: =colDepartments
MyGallery.Items: =Filter(colUsers, Status = "Active")

# ‚ùå SAI - Table() recreated every time, poor performance
MyDropdown.Items: =Table({Name: "IT"}, {Name: "HR"}, {Name: "Finance"})
```

**Table() Function - Limited Use Cases Only**:
```yaml
# ‚úÖ CH·∫§P NH·∫¨N - Table() cho single-use lookup trong formulas
LookUp: =LookUp(
  Table({Min: 0, Max: 100, Grade: "A"}, {Min: 80, Max: 99, Grade: "B"}),
  score >= Min And score <= Max
).Grade

# ‚úÖ CH·∫§P NH·∫¨N - Table() trong complex calculations
Result: =Sum(
  Table({Factor: 1.2}, {Factor: 1.5}, {Factor: 0.8}),
  baseValue * Factor
)

# ‚ùå SAI - Table() cho dropdown options, gallery items, any UI data binding
```

---

## 3. CONTROL Z-INDEX & RENDERING ORDER

### 3.1 Critical Z-Index Rules
**B·∫ÆT BU·ªòC**: Controls ƒë∆∞·ª£c render theo th·ª© t·ª± xu·∫•t hi·ªán trong YAML. Controls sau xu·∫•t hi·ªán **TR√äN TOP** c·ªßa controls tr∆∞·ªõc.

```yaml
# ‚úÖ ƒê√öNG - Th·ª© t·ª± layering ƒë√∫ng
Children:
  # 1. BACKGROUND LAYERS (render tr∆∞·ªõc, ·ªü bottom)
  - Background:
      Control: Rectangle
      
  # 2. CONTAINER LAYERS 
  - MainContainer:
      Control: GroupContainer
      
  # 3. CONTENT LAYERS
  - ContentArea:
      Control: Rectangle
      Children:
        - TextLabel:
            Control: Label
        - InputField:
            Control: Classic/TextInput
            
  # 4. INTERACTIVE LAYERS
  - ActionButton:
      Control: Classic/Button
      
  # 5. OVERLAY LAYERS (render cu·ªëi, ·ªü top)
  - HoverOverlay:
      Control: Rectangle
  - LoadingSpinner:
      Control: Classic/Icon
```

### 3.2 Mandatory Layer Hierarchy
**CRITICAL**: Lu√¥n tu√¢n th·ªß th·ª© t·ª± n√†y cho control declarations:

#### Level 1: Background & Foundation (ƒê·∫ßu ti√™n)
- Background controls - render ·ªü bottom layer

#### Level 2: Layout Containers  
- Container controls - structural layout

#### Level 3: Static Content
- Static display elements

#### Level 4: Interactive Content
- Form inputs v√† data displays

#### Level 5: Action Controls
- Buttons v√† action triggers

#### Level 6: Status & Feedback (Cu·ªëi c√πng)
- Status indicators v√† overlays - render ·ªü top layer

---

## 4. CONTROL VARIANTS

### 4.1 GroupContainer Variants
```yaml
Variant: ManualLayout
Variant: AutoLayout
```

### 4.2 Gallery Variants
```yaml
Variant: Vertical
Variant: Horizontal
Variant: VariableHeight
```

### 4.3 Form Variants
```yaml
Variant: Classic
```

### 4.4 Arrow Variants
```yaml
Variant: BackArrow
```

### 4.5 Star Variants
```yaml
Variant: 5Points
Variant: 6Points
Variant: 8Points
Variant: 12Points
```

---

## üö® CRITICAL ERROR FIXES

### PA2108 Error Prevention

#### Rectangle v·ªõi Event Properties
```yaml
# ‚ùå WRONG - Rectangle kh√¥ng h·ªó tr·ª£ event properties nh∆∞ OnSelect
# ‚úÖ CORRECT - S·ª≠ d·ª•ng Rectangle cho visual, GroupContainer cho layout, Classic/Button cho interaction
```

#### Gallery VariableHeight v·ªõi WrapCount
```yaml
# ‚ùå WRONG - VariableHeight kh√¥ng h·ªó tr·ª£ WrapCount
# ‚úÖ CORRECT - X√≥a WrapCount cho VariableHeight ho·∫∑c ƒë·ªïi variant
```

#### Classic/Button Invalid Properties
```yaml
# ‚ùå WRONG - Classic/Button kh√¥ng h·ªó tr·ª£ BorderRadius, Disabled, Align
# ‚úÖ CORRECT - S·ª≠ d·ª•ng DisplayMode thay Disabled, b·ªè c√°c properties kh√¥ng h·ªó tr·ª£
```

#### DataTable v·ªõi Event Properties
```yaml
# ‚ùå WRONG - DataTable kh√¥ng h·ªó tr·ª£ event properties nh∆∞ OnSelect
# ‚úÖ CORRECT - S·ª≠ d·ª•ng GroupContainer cho layout, Classic/Button cho interaction
```

#### DataTable v·ªõi Properties sai
```yaml
# ‚ùå WRONG - DataTable v·ªõi properties sai
- 'MyDataTable':
    Control: DataTable
    Properties:
      Items: =MyDataSource
      OnSelect: |
        =Set(varSelectedItem, ThisItem)  # ERROR - ThisItem not available

# ‚úÖ ƒê√öNG - DataTable v·ªõi properties ƒë√∫ng
- 'MyDataTable':
    Control: DataTable
    Properties:
      Items: =MyDataSource
      OnSelect: |
        =Set(varSelectedItem, Self.Selected)
```

---

**CRITICAL REMINDERS:**

70. **DATATABLE CRUD PRIORITIZATION** - CRITICAL: Always use DataTable when screen has Create/Edit/Delete forms or CRUD operations. Gallery is NOT suitable for data management screens with forms
71. **DATATABLE MANAGEMENT SCREENS** - CRITICAL: All "Management" pattern screens (UserManagement, RequestManagement, etc.) MUST use DataTable with proper Add/Edit/Delete functionality
72. **DATATABLE SCREEN CHILDREN** - CRITICAL: DataTable controls must be direct children of Screens only. Never nest inside GroupContainer or other containers
73. **DATATABLECOLUMN REQUIRED PROPERTIES** - CRITICAL: Every DataTableColumn must have FieldDisplayName, FieldName, Order, and Text properties. Missing any causes display errors
74. **DATATABLE ONSELECT FORBIDDEN** - CRITICAL: DataTable does NOT support OnSelect property (PA2108 error). Selection is handled automatically
75. **DATATABLECOLUMN CUSTOM VARIANT FORBIDDEN** - CRITICAL: DataTableColumn does NOT support Custom variant (PA2109 error). Use only Textual, Number, DateTime, Boolean
76. **DATATABLE VERSION RESTRICTIONS** - CRITICAL: Never use version numbers (@1.0.3) with DataTable or DataTableColumn controls
77. **DATATABLE PERFORMANCE FILTERING** - CRITICAL: Always filter data at source level before passing to DataTable Items property. Never rely on DataTable internal filtering for large datasets
78. **DATATABLECOLUMN DISPLAY ONLY** - CRITICAL: DataTableColumn is for data display only. No OnSelect or event properties. Use ThisItem.fieldname for data binding
79. **DATATABLE SELECTION HANDLING** - CRITICAL: DataTable does NOT support OnSelectionChange (PA2108 error). Use separate overlay Rectangle with OnSelect to detect DataTable.Selected for context menus
80. **CONTEXT MENU Z-INDEX** - CRITICAL: Context menus must be positioned LAST trong Children array ƒë·ªÉ ensure highest z-index
81. **CLASSIC/TEXTINPUT FOCUS PROPERTY** - CRITICAL: Classic/TextInput ch·ªâ h·ªó tr·ª£ .Focus, KH√îNG h·ªó tr·ª£ .Focused (PA2108 error)
82. **INPUT & DROPDOWN FOCUS RESTRICTIONS** - CRITICAL: T·∫§T C·∫¢ Input controls (bao g·ªìm "input" n√≥i chung) KH√îNG c√≥ .Focus ho·∫∑c .Focused properties (PA2108 error), CH·ªà NGO·∫†I TR·ª™ Classic/TextInput. S·ª¨ D·ª§NG: FocusedBorderColor + FocusedBorderThickness cho styling, OnSelect cho tracking. Includes Classic/DropDown, Classic/ComboBox, Classic/DatePicker, Classic/CheckBox, Classic/Radio, Classic/Toggle, Classic/Slider, Rating, PenInput
83. **COLLECTION VS TEXT FUNCTIONS** - CRITICAL: Concatenate() cho text only, Concat() cho collections/tables only. Wrong usage causes invalid argument errors
84. **TABLE() FUNCTION RESTRICTIONS** - CRITICAL: ALWAYS AVOID Table() function. Use ClearCollect/Collect/Remove/Update instead for better performance v√† state management. Table() only acceptable for single-use lookups/calculations
85. **DATATABLE ONSELECTIONCHANGE PA2108 ERROR** - CRITICAL: DataTable does NOT support OnSelectionChange property (PA2108 error). Use separate Rectangle overlay with OnSelect positioned over DataTable for selection handling

---

**Agent ph·∫£i tu√¢n th·ªß nh·ªØng quy t·∫Øc controls n√†y TUY·ªÜT ƒê·ªêI khi t·∫°o Power App YAML code.**